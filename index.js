webpackJsonp([1,0],[function(e,t,n){function o(e){if("undefined"==typeof e||null==e||e+""=="")return!1;var t=e.split(" "),n=!0;if(t.length>0)for(var o=0;o<t.length;o++)""!==t[o]&&(n=!1);return!n}function i(e){if(null==e||""===e||"undefined"==typeof e)return"";var t=new Date(e),n=t.getFullYear(),o=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),i=t.getDate()>9?t.getDate():"0"+t.getDate(),a=t.getHours()+1>9?t.getHours():"0"+t.getHours(),r=t.getMinutes()+1>9?t.getMinutes():"0"+t.getMinutes(),s=t.getSeconds()+1>9?t.getSeconds():"0"+t.getSeconds();return n+"-"+o+"-"+i+" "+a+":"+r+":"+s}function a(){var e,t=decodeURI(location.search),n={};if("?"===t.charAt(0))if(t=t.substring(1,t.length),t.indexOf("&")!==-1){e=t.split("&");for(var o=0;o<e.length;o++){var i=e[o].split("=");2===i.length&&""!==i[0]&&(n[i[0]]=i[1])}}else e=t.split("="),2===e.length&&""!==e[0]&&(n[e[0]]=e[1]);return n}n(5),n(4),n(1),n(2),n(3);var r={versions:function(){var e=navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")===-1,weixin:e.indexOf("MicroMessenger")>-1,qq:e.match(/\sQQ/i)}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},s=angular.module("main",[]);s.controller("mainCtrl",["$scope","$http","$interval","$timeout",function(e,t,n){function s(){var t=location.href,n=e.userDisc,o=e.shareTitle,i=e.thumbnail;wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareQZone","updateAppMessageShareData","updateTimelineShareData","onMenuShareWeibo"]}),wx.ready(function(){wx.onMenuShareWeibo({title:n,desc:o,link:t,imgUrl:i},function(){e.addShare()}),wx.onMenuShareAppMessage({title:n,desc:o,link:t,imgUrl:i,success:function(){e.addShare()}}),wx.onMenuShareTimeline({title:n,desc:o,link:t,imgUrl:i,success:function(){e.addShare()}}),wx.onMenuShareQQ({title:n,desc:o,link:t,imgUrl:i,success:function(){e.addShare()}}),wx.onMenuShareQZone({title:n,desc:o,link:t,imgUrl:i,success:function(){e.addShare()}})})}function c(){if(1===e.showType&&!e.showLoading){e.isGyro=!1,e.showLoading=!0;var t=0;e.orbitControls.minDistance=100,e.orbitControls.maxDistance=268,e.camera.position.set(0,268,0),e.initTimer=n(function(){e.fov+=80/108,t++,t>108&&(e.showLoading=!1,e.orbitControls.minDistance=100,e.orbitControls.maxDistance=268,e.orbitControls.autoRotate=!0,e.orbitControls.autoRotateSpeed=1,e.camera.position.set(0,268,0),n.cancel(e.initTimer)),e.orbitControls.dollyIn(),e.orbitControls.update()},1)}}function u(){if(2===e.showType&&!e.showLoading){if(e.showLoading=!0,e.isGyro)e.fov=70,e.camera.position.set(0,0,0),e.orbitControls.reset(),e.orbitControls.minDistance=1,e.orbitControls.maxDistance=1,e.orbitControls.update(),e.showLoading=!1;else{e.orbitControls.target.set(e.camera.position.x+.001,e.camera.position.y,e.camera.position.z),e.orbitControls.minDistance=1,e.orbitControls.maxDistance=200;var t=0;e.normalTimer=n(function(){t++,t>200&&(e.showLoading=!1,n.cancel(e.normalTimer)),e.orbitControls.dollyIn(),e.orbitControls.update()},10)}e.orbitControls.autoRotate=!0,e.orbitControls.autoRotateSpeed=1}}function d(){3!==e.showType||e.showLoading||(e.isGyro=!1,e.showLoading=!0,e.orbitControls.target.set(e.camera.position.x+.001,e.camera.position.y,e.camera.position.z),e.orbitControls.minDistance=690,e.orbitControls.maxDistance=1100,e.orbitControls.autoRotate=!0,e.orbitControls.autoRotateSpeed=1,e.orbitControls.dollyIn(),e.orbitControls.update(),e.showLoading=!1)}function l(){function e(){var e=n.find("canvas").get(0),o=new Image;o.src=e.toDataURL("image/jpg"),o.onload=function(){a.drawImage(this,0,0,160,160,84.8*i,65.3*i,130*i,130*i),t()}}function t(){var e=new Image;e.src="./img/logo.png",e.onload=function(){a.drawImage(this,0,0,60,60,130.3*i,110.8*i,39*i,39*i);var e=new Image;e.src=o.toDataURL("image/jpg"),document.getElementById("canvasBox").appendChild(e)}}var n=$("#qrcodeCanvas").qrcode({text:window.location.href,width:160,height:160,background:"#ffffff",foreground:"#000000"}),o=document.getElementById("downLoadCanvas"),i=window.devicePixelRatio;o.width=o.width*i,o.height=o.height*i;var a=o.getContext("2d");a.fillStyle="#FFFFFF";var r=new Image;r.src="./img/code_bg.png",r.onload=function(){a.drawImage(this,0,0,460,530,0,0,o.width,o.height),e()}}function h(t){2===t.touches.length&&(e.distance.start=p({x:t.touches[0].pageX,y:t.touches[0].pageY},{x:t.touches[1].pageX,y:t.touches[1].pageY}))}function m(t){if(2===t.touches.length&&!e.isGyro&&2===e.showType){e.distance.stop=p({x:t.touches[0].pageX,y:t.touches[0].pageY},{x:t.touches[1].pageX,y:t.touches[1].pageY});var n=e.distance.stop/e.distance.start;n>1?e.fov-=.8:e.fov+=.8,e.fov<=30?e.fov=30:e.fov>=70?e.fov=70:void 0}}function p(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function g(){var e=window.document.location.href,t=window.document.location.pathname,n=e.indexOf(t),o="";return o=""===window.document.location.port?e.substring(0,n):e.substring(0,n-5)}function f(){w(),e.camera.aspect=window.innerWidth/window.innerHeight,e.camera.updateProjectionMatrix(),e.renderer.setSize(window.innerWidth,window.innerHeight),e.showMore.status=!1,e.$apply()}function w(){var e;e=document.documentElement.clientWidth>360?360:document.documentElement.clientWidth,document.documentElement.style.fontSize=e/3.6+"px"}e.environment=!1,e.turnIconInfo="请关闭手机竖屏锁定,并横置手机。",e.isShow=!0,e.loading=!0,e.musicStatus=!1,e.isShare=!1,e.isVr=!1,e.isGyro=!1,e.imgPath="",e.userIcon="",e.iosLink="",e.androidLink="",e.userDisc="",e.vectorArray=[],e.musicSrc="",e.userName="",e.createTime="",e.workId=a().id,e.fov=70,e.distance={},e.showType=1,e.showMore={},e.showMore.status=!1,e.showLoading=!1,e.language=navigator.language,"zh-CN"===e.language?e.languageSet={gy:"陀螺仪",code:"二维码",downLoad:"下载"}:(e.languageSet={gy:"Gyro",code:"QR code",downLoad:"download"},e.turnIconInfo="Please turn off the phone's portrait lock and tap the phone."),r.versions.mobile&&r.versions.ios&&/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)&&/QQ/i.test(navigator.userAgent)&&(e.turnIconInfo="亲，由于iphoneQQ无法横屏，请移驾Safari浏览器中获取cardboard体验！"),e.getALLInfo=function(){t({method:"POST",url:g()+"/api/work/findWorkbyId",data:JSON.stringify({workId:e.workId})}).success(function(t){if(1===t.code){if(e.getWxConfig(),o(t.data.name)?document.title=t.data.name:document.title="MoisPano",e.shareTitle=t.data.name,e.shareTitle||(e.shareTitle="MoisPano作品分享"),e.userName=t.data.user.userName,e.lookCount=t.data.lookCount,e.userDisc=t.data.say,"zh-CN"!==e.language&&/这个人很懒/.test(e.userDisc)&&(e.userDisc="A lazy person, nothing said!"),e.createTime=i(Number(t.data.createTime)),/http/.test(t.data.path)?e.imgPath=t.data.path:e.imgPath="http://moispanopro.oss-cn-shenzhen.aliyuncs.com/"+t.data.path,e.thumbnail="http://moispanopro.oss-cn-shenzhen.aliyuncs.com/"+t.data.path+"?x-oss-process=image/resize,h_100",e.imgPath=e.imgPath+"?"+(new Date).getTime(),e.loadImg(),e.musicSrc=t.data.music,/http/.test(t.data.user.avatar)?e.userIcon=t.data.user.avatar:e.userIcon=g()+"/"+t.data.user.avatar,o(e.userIcon)||(e.userIcon="./img/default_head.png"),o(e.musicSrc)){var n=document.getElementById("audio");n.setAttribute("src",e.musicSrc),r.versions.android&&(n.play(),e.musicStatus=!0)}l(),e.addLookCountShare()}else alert("获取作品失败！")}),t({method:"POST",url:g()+"/api/work/findComments",data:JSON.stringify({workId:e.workId})}).success(function(t){1===t.code&&(e.vectorArray=t.data.comments)}),e.iosLink="https://www.paipai360.com/public/qr/ercode.html?id=20210717-5a65-435e-9080-a86feef6b2fe",e.androidLink="https://www.paipai360.com/public/qr/ercode.html?id=20210717-5a65-435e-9080-a86feef6b2fe"},e.addShare=function(){t({method:"POST",url:g()+"/api/work/addShare2Count",data:JSON.stringify({workId:e.workId})}).success(function(e){1===e.code&&console.log("微信二次分享成功")})},e.addLookCountShare=function(){t({method:"POST",url:g()+"/api/work/addLookCount",data:JSON.stringify({workId:e.workId})}).success(function(e){1===e.code&&console.log("分享次数增加")})},e.loadImg=function(){var t=new Image;t.crossOrigin="anonymous",t.src=e.imgPath,t.onload=function(){e.$apply(function(){e.init(),e.loading=!1})}},e.getWxConfig=function(){t({method:"POST",url:g()+"/api/work/signature",data:JSON.stringify({url:location.href})}).success(function(t){1===t.code&&(console.log(JSON.stringify({url:location.href})),e.appId=t.data.appId,e.timestamp=t.data.timestamp,e.nonceStr=t.data.nonceStr,e.signature=t.data.signature,s())})},e.updateMesh=function(){e.scene.remove(e.mesh);var t=new THREE.TextureLoader;r.versions.webKit?t.crossOrigin="anonymous":t.crossOrigin="",t.load(e.imgPath,function(t){var n=new THREE.SphereGeometry(300,200,22),o=new THREE.MeshBasicMaterial({map:t,transparent:!0,side:THREE.DoubleSide});e.mesh=new THREE.Mesh(n,o),e.mesh.scale.x=-1,e.scene.add(e.mesh)})},e.init=function(){e.scene=new THREE.Scene,e.scene.background=new THREE.Color(16777215),e.camera=new THREE.PerspectiveCamera(e.fov,window.innerWidth/window.innerHeight,1,1e3),e.camera.target=new THREE.Vector3(0,0,0),e.camera.position.set(0,0,0),e.camera.lookAt(e.scene.position),e.scene.add(e.camera),e.renderer=new THREE.WebGLRenderer,e.renderer.setClearColor(16777215,1),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(window.innerWidth,window.innerHeight),e.element=e.renderer.domElement,document.getElementById("wrap").appendChild(e.element),e.effect=new THREE.StereoEffect(e.renderer),e.orbitControls=new THREE.OrbitControls(e.camera,e.renderer.domElement),e.orbitControls.target.set(e.camera.position.x+.01,e.camera.position.y,e.camera.position.z),e.orbitControls.pan(10,10),e.orbitControls.minDistance=1,e.orbitControls.maxDistance=200,e.orientationControls=new THREE.DeviceOrientationControls(e.camera,!0),e.updateMesh(),window.addEventListener("resize",f,!1),e.element.addEventListener("touchstart",h,!1),e.element.addEventListener("touchmove",m,!1),c(),e.animate()},e.animate=function(){requestAnimationFrame(e.animate);var t=window.innerWidth,n=window.innerHeight;e.camera.fov=e.fov,e.camera.aspect=t/n,e.camera.updateProjectionMatrix(),e.renderer.setSize(t,n),e.renderer.setClearColor(16777215),e.effect.setSize(t,n),e.isGyro?(e.orbitControls.minDistance=1,e.orbitControls.maxDistance=1,e.orientationControls.connect(),e.orientationControls.update()):e.orbitControls.update(),e.isVr?90===window.orientation||window.orientation===-90?(e.effect.render(e.scene,e.camera),$(".turnIcon").hide()):($(".turnIcon").show(),e.renderer.render(e.scene,e.camera)):($(".turnIcon").hide(),e.renderer.render(e.scene,e.camera))},e.showControl=function(t){if(t.stopPropagation(),!e.showLoading)switch(e.showType++,e.showType>3&&(e.showType=1),e.fov=70,e.camera.position.set(0,0,0),e.orbitControls.reset(),e.orbitControls.minDistance=1,e.orbitControls.maxDistance=1,e.orbitControls.update(),e.showType){case 1:c();break;case 2:u();break;case 3:d()}},e.musicPlay=!1,e.showHide=function(t){var n=document.getElementById("audio");null===n||e.musicPlay||(n.play(),e.musicStatus=!0,e.musicPlay=!0),t.cancelable&&(t.defaultPrevented||t.preventDefault()),e.orbitControls.autoRotate=!1,t&&t.stopPropagation?t.stopPropagation():window.event?window.event.cancelBubble=!0:void 0,e.isShow=!e.isShow,e.isVr&&(e.isShow=!1)},e.hideCode=function(){e.isShare=!1,event.stopPropagation()},e.showCode=function(t){e.isShare=!e.isShare,t.stopPropagation()},e.showMoreControl=function(t){e.showMore.status=!e.showMore.status,t.stopPropagation()},e.playMusic=function(t){t.stopPropagation();var n=document.getElementById("audio");null!==n&&(4!==n.readyState&&r.versions.android?o(e.musicSrc)&&(alert("亲！美妙的音乐即将响起，请稍候！"),e.musicStatus=!1):n.paused?(n.play(),e.musicStatus=!0):(n.pause(),e.musicStatus=!1))},e.downLoad=function(t){t.stopPropagation(),r.versions.mobile&&r.versions.android?window.open(e.androidLink):r.versions.mobile&&r.versions.ios&&window.open(e.iosLink)},e.jdDownLoad=function(e){e.stopPropagation(),window.open("https://item.jd.com/13212863931.html")},e.downLoadCode=function(e){e.stopPropagation()},e.exitVr=function(t){t.stopPropagation(),e.isVr=!1},e.vrControl=function(t){t.stopPropagation(),e.isVr=!e.isVr,e.isGyro=!0,e.showType=2,u(),$(document).fullScreen(!0)},e.gyroControl=function(t){t.stopPropagation(),e.isGyro=!e.isGyro,e.showType=2,u()},~function(){if(e.environment)e.getALLInfo();else{e.imgPath="./img/720_2.jpg",e.userName="落尘",e.lookCount=100,e.userDisc="这个人很懒,什么也没说！","zh-CN"!==e.language&&/这个人很懒/.test(e.userDisc)&&(e.userDisc="A lazy person, noting said!"),e.createTime="2018年10月10日",e.userIcon="./img/user.jpg";var t=document.getElementById("audio");t.setAttribute("src",e.musicSrc),r.versions.android&&(t.play(),e.musicStatus=!0),e.loadImg(),l()}}()}]),s.config(["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/json;charset=utf-8"}]),angular.element(document).ready(function(){angular.bootstrap(document,["main"])}),e.exports=s},function(e,t){!function(){function e(e){o=e}function t(){switch(window.screen.orientation||window.screen.mozOrientation){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0}return window.orientation||0}function n(){i=t()}var o={},i=window.orientation||0;window.addEventListener("deviceorientation",e,!1),window.addEventListener("orientationchange",n,!1),THREE.DeviceOrientationControls=function(e){this.object=e,this.object.rotation.reorder("YXZ"),this.freeze=!0,this.movementSpeed=1,this.rollSpeed=.005,this.autoAlign=!0,this.autoForward=!1,this.alpha=0,this.beta=0,this.gamma=0,this.orient=0,this.alignQuaternion=new THREE.Quaternion,this.orientationQuaternion=new THREE.Quaternion;var t=new THREE.Quaternion,n=new THREE.Quaternion,a=new THREE.Vector3,r=new THREE.Matrix4,s=new THREE.Euler(0,0,0,"YXZ"),c=new THREE.Quaternion,u=new THREE.Vector3(0,0,1),d=new THREE.Vector3(0,1,0),l=new THREE.Vector3(0,0,0),h=new THREE.Euler,m=new THREE.Quaternion,p=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));this.update=function(e){return function(e){this.freeze||(this.alpha=o.gamma?THREE.Math.degToRad(o.alpha):0,this.beta=o.beta?THREE.Math.degToRad(o.beta):0,this.gamma=o.gamma?THREE.Math.degToRad(o.gamma):0,this.orient=i?THREE.Math.degToRad(i):0,h.set(this.beta,this.alpha,-this.gamma,"YXZ"),t.setFromEuler(h),n.slerp(t,.5),this.autoAlign?this.orientationQuaternion.copy(t):this.orientationQuaternion.copy(n),this.orientationQuaternion.multiply(p),this.orientationQuaternion.multiply(m.setFromAxisAngle(u,-this.orient)),this.object.quaternion.copy(this.alignQuaternion),this.object.quaternion.multiply(this.orientationQuaternion),this.autoForward&&(a.set(0,0,-1).applyQuaternion(this.object.quaternion,"ZXY").setLength(this.movementSpeed/50),this.object.position.add(a)),this.autoAlign&&0!==this.alpha&&(this.autoAlign=!1,this.align()))}}(),this.align=function(){a.set(0,0,-1).applyQuaternion(c.copy(this.orientationQuaternion).inverse(),"ZXY"),s.setFromQuaternion(c.setFromRotationMatrix(r.lookAt(a,l,d))),s.set(0,s.y,0),this.alignQuaternion.setFromEuler(s)},this.connect=function(){this.freeze=!1},this.disconnect=function(){this.freze=!0}}}()},function(e,t){THREE.OrbitControls=function(e,t){function n(){return 2*Math.PI/60/60*h.autoRotateSpeed}function o(){return Math.pow(.95,h.zoomSpeed)}function i(e){if(h.enabled!==!1){if(e.preventDefault(),0===e.button){if(h.noRotate===!0)return;k=L.ROTATE,p.set(e.clientX,e.clientY)}else if(1===e.button){if(h.noZoom===!0)return;k=L.DOLLY,T.set(e.clientX,e.clientY)}else if(2===e.button){if(h.noPan===!0)return;k=L.PAN,w.set(e.clientX,e.clientY)}h.domElement.addEventListener("mousemove",a,!1),h.domElement.addEventListener("mouseup",r,!1),h.dispatchEvent(A)}}function a(e){if(h.enabled!==!1){e.preventDefault();var t=h.domElement===document?h.domElement.body:h.domElement;if(k===L.ROTATE){if(h.noRotate===!0)return;g.set(e.clientX,e.clientY),f.subVectors(p,g),h.rotateLeft(2*Math.PI*f.x/t.clientWidth*h.rotateSpeed),h.rotateUp(2*Math.PI*f.y/t.clientHeight*h.rotateSpeed),p.copy(g)}else if(k===L.DOLLY){if(h.noZoom===!0)return;S.set(e.clientX,e.clientY),C.subVectors(S,T),C.y>0?h.dollyIn():h.dollyOut(),T.copy(S)}else if(k===L.PAN){if(h.noPan===!0)return;E.set(e.clientX,e.clientY),v.subVectors(E,w),h.pan(v.x,v.y),w.copy(E)}h.update()}}function r(){h.enabled!==!1&&(h.domElement.removeEventListener("mousemove",a,!1),h.domElement.removeEventListener("mouseup",r,!1),h.dispatchEvent(F),k=L.NONE)}function s(e){if(h.enabled!==!1&&h.noZoom!==!0){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?h.dollyOut():h.dollyIn(),h.update(),h.dispatchEvent(A),h.dispatchEvent(F)}}function c(e){if(h.enabled!==!1&&h.noKeys!==!0&&h.noPan!==!0)switch(e.keyCode){case h.keys.UP:h.pan(0,h.keyPanSpeed),h.update();break;case h.keys.BOTTOM:h.pan(0,-h.keyPanSpeed),h.update();break;case h.keys.LEFT:h.pan(h.keyPanSpeed,0),h.update();break;case h.keys.RIGHT:h.pan(-h.keyPanSpeed,0),h.update()}}function u(e){if(h.enabled!==!1){switch(e.touches.length){case 1:if(h.noRotate===!0)return;k=L.TOUCH_ROTATE,p.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(h.noZoom===!0)return;k=L.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);T.set(0,o);break;case 3:if(h.noPan===!0)return;k=L.TOUCH_PAN,w.set(e.touches[0].pageX,e.touches[0].pageY);break;default:k=L.NONE}h.dispatchEvent(A)}}function d(e){if(h.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=h.domElement===document?h.domElement.body:h.domElement;switch(e.touches.length){case 1:if(h.noRotate===!0)return;if(k!==L.TOUCH_ROTATE)return;g.set(e.touches[0].pageX,e.touches[0].pageY),f.subVectors(p,g),h.rotateLeft(2*Math.PI*f.x/t.clientWidth*h.rotateSpeed),h.rotateUp(2*Math.PI*f.y/t.clientHeight*h.rotateSpeed),p.copy(g),h.update();break;case 2:if(h.noZoom===!0)return;if(k!==L.TOUCH_DOLLY)return;var n=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(n*n+o*o);S.set(0,i),C.subVectors(S,T),C.y>0?h.dollyOut():h.dollyIn(),T.copy(S),h.update();break;case 3:if(h.noPan===!0)return;if(k!==L.TOUCH_PAN)return;E.set(e.touches[0].pageX,e.touches[0].pageY),v.subVectors(E,w),h.pan(v.x,v.y),w.copy(E),h.update();break;default:k=L.NONE}}}function l(){h.enabled!==!1&&(h.dispatchEvent(F),k=L.NONE)}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var h=this,m=1e-6,p=new THREE.Vector2,g=new THREE.Vector2,f=new THREE.Vector2,w=new THREE.Vector2,E=new THREE.Vector2,v=new THREE.Vector2,b=new THREE.Vector3,y=new THREE.Vector3,T=new THREE.Vector2,S=new THREE.Vector2,C=new THREE.Vector2,R=0,M=0,x=1,H=new THREE.Vector3,P=new THREE.Vector3,L={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},k=L.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var O=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),I=O.clone().inverse(),D={type:"change"},A={type:"start"},F={type:"end"};this.rotateLeft=function(e){void 0===e&&(e=n()),M-=e},this.rotateUp=function(e){void 0===e&&(e=n()),R-=e},this.panLeft=function(e){var t=this.object.matrix.elements;b.set(t[0],t[1],t[2]),b.multiplyScalar(-e),H.add(b)},this.panUp=function(e){var t=this.object.matrix.elements;b.set(t[4],t[5],t[6]),b.multiplyScalar(e),H.add(b)},this.pan=function(e,t){var n=h.domElement===document?h.domElement.body:h.domElement;if(void 0!==h.object.fov){var o=h.object.position,i=o.clone().sub(h.target),a=i.length();a*=Math.tan(h.object.fov/2*Math.PI/180),h.panLeft(2*e*a/n.clientHeight),h.panUp(2*t*a/n.clientHeight)}else void 0!==h.object.top?(h.panLeft(e*(h.object.right-h.object.left)/n.clientWidth),h.panUp(t*(h.object.top-h.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=o()),x/=e},this.dollyOut=function(e){void 0===e&&(e=o()),x*=e},this.update=function(){var e=this.object.position;y.copy(e).sub(this.target),y.applyQuaternion(O);var t=Math.atan2(y.x,y.z),o=Math.atan2(Math.sqrt(y.x*y.x+y.z*y.z),y.y);this.autoRotate&&this.rotateLeft(n()),t+=M,o+=R,o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(m,Math.min(Math.PI-m,o));var i=y.length()*x;i=Math.max(this.minDistance,Math.min(this.maxDistance,i)),this.target.add(H),y.x=i*Math.sin(o)*Math.sin(t),y.y=i*Math.cos(o),y.z=i*Math.sin(o)*Math.cos(t),y.applyQuaternion(I),e.copy(this.target).add(y),this.object.lookAt(this.target),M=0,R=0,x=1,H.set(0,0,0),P.distanceToSquared(this.object.position)>m&&(this.dispatchEvent(D),P.copy(this.object.position))},this.reset=function(){k=L.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",u,!1),this.domElement.addEventListener("touchend",l,!1),this.domElement.addEventListener("touchmove",d,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype)},function(e,t){THREE.StereoEffect=function(e){this.separation=3,this.focalLength=80;var t,n,o,i,a,r,s,c,u,d,l,h,m=new THREE.Vector3,p=new THREE.Quaternion,g=new THREE.Vector3,f=new THREE.PerspectiveCamera,w=new THREE.PerspectiveCamera;e.autoClear=!1,this.setSize=function(o,i){t=o/2,n=i,e.setSize(o,i)},this.render=function(E,v){E.updateMatrixWorld(),void 0===v.parent&&v.updateMatrixWorld(),v.matrixWorld.decompose(m,p,g),o=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(v.fov)))),c=v.near/this.focalLength,d=Math.tan(.5*THREE.Math.degToRad(o))*this.focalLength,u=.5*d*v.aspect,r=d*c,s=-r,l=(u+this.separation/2)/(2*u),h=1-l,i=2*u*c*h,a=2*u*c*l,f.projectionMatrix.makeFrustum(-i,a,s,r,v.near,v.far),f.position.copy(m),f.quaternion.copy(p),f.translateX(-this.separation/2),w.projectionMatrix.makeFrustum(-a,i,s,r,v.near,v.far),w.position.copy(m),w.quaternion.copy(p),w.translateX(this.separation/2),e.setViewport(0,0,2*t,n),e.clear(),e.setViewport(0,0,t,n),e.render(E,f),e.setViewport(t,0,t,n),e.render(E,w)}}},function(e,t){function n(e){var t,n;return this.length?(t=this[0],t.ownerDocument?n=t.ownerDocument:(n=t,t=n.documentElement),null==e?n.exitFullscreen||n.webkitExitFullscreen||n.webkitCancelFullScreen||n.msExitFullscreen||n.mozCancelFullScreen?(e=!!(n.fullscreenElement||n.msFullscreenElement||n.webkitIsFullScreen||n.mozFullScreen),e?n.fullscreenElement||n.webkitFullscreenElement||n.webkitCurrentFullScreenElement||n.msFullscreenElement||n.mozFullScreenElement||e:e):null:(e?(e=t.requestFullscreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.msRequestFullscreen||t.mozRequestFullScreen)&&e.call(t):(e=n.exitFullscreen||n.webkitExitFullscreen||n.webkitCancelFullScreen||n.msExitFullscreen||n.mozCancelFullScreen)&&e.call(n),this)):this}jQuery.fn.fullScreen=n,jQuery.fn.toggleFullScreen=function(){return n.call(this,!n.call(this))};var o,i,a;o=document,o.webkitCancelFullScreen?(i="webkitfullscreenchange",a="webkitfullscreenerror"):o.msExitFullscreen?(i="MSFullscreenChange",a="MSFullscreenError"):o.mozCancelFullScreen?(i="mozfullscreenchange",a="mozfullscreenerror"):(i="fullscreenchange",a="fullscreenerror"),jQuery(document).bind(i,function(){jQuery(document).trigger(new jQuery.Event("fullscreenchange"))}),jQuery(document).bind(a,function(){jQuery(document).trigger(new jQuery.Event("fullscreenerror"))})},function(e,t){}]);